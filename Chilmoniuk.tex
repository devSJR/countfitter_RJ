% !TeX root = RJwrapper.tex
\title{\emph{countfitteR}: a web server for the analysis of count data}
\author{by Jaros\l{}aw Chilmoniuk, Madeleine Ruhe, Stefan R\"{o}diger and Micha\l{} Burdukiewicz}

\maketitle

\abstract{
An abstract of less than 150 words.
}

\section{ToDo}

\begin{itemize}
 \item Hurdle Model (Hu,M.-C. et al. (2011) Zero-Inflated and Hurdle Models of Count Data with Extra Zeros: Examples from an HIV-Risk Reduction Intervention Trial. The American Journal of Drug and Alcohol Abuse, 37, 367â€“375.)
\end{itemize}


\section{Section title in sentence case}

We extend the statistical method for other absolute countable 
biomolecule complexes such as $\gamma H2AX$ foci, which is an important 
biodositometer during radiation treatment. Our system facilitates the digital 
enumeration of DNA double-strand breaks (DSB) via the phosphorylated histone 
variant H2AX ($\gamma H2AX$). $\gamma H2AX$ is an important biomarker of physiological 
and pathological cellular processes \cite{reddig_dna_2018,rodiger_quantification_2018}. In addition, associated biomarkers such as 
the p53-binding protein 1 (53BP1) may also be detected during the screening. The 
foci quantification is a fast and sensitive approach for detection of one of the 
critical types of DNA damage introduced by radiation, cellular process or toxic 
agent with applications in research and clinical environment (e.g., individual 
radiosensitivity). Although these biomarkers play a crucial role in diagnostics, 
their levels vary not only between patients but also between replicates. We 
aimed to create a tool, which simplifies necessary, but often omitted, step in a 
statistical analysis of foci count data: the selection of count distribution.

The Poisson model is typically used for count data in the context of DSBs. However, 
real foci data often do not satisfy constraints implied by this distribution. 
This suggests that another probability distribution for positive integers may 
describe a data set more accurately. Therefore, an identification of the probability 
distribution of $\gamma H2AX$ foci and associated biomarkers is vital for the 
precise estimation of the mean number of foci per cell and its confidence 
intervals.

Most statistical tests developed for determining if data is 
Poisson-distributed, test the equality of variance and mean. The data is 
considered overdispersed when the variance is significantly higher than the 
mean. We consider two possible causes for overdispersion. Firstly, the extreme 
values (both very high and very low counts) may occur more often than it is 
assumed in the Poisson distribution. Such situations are well modeled by the 
negative binomial (NB) distribution. Despite the fact that the NB distribution 
is used primarily for counting the number of failures before a predetermined 
number of successes occurs, it can be also alternatively parametrized to 
describe count data with non-equal variance and mean. One of the important 
properties of the NB distribution is that the maximum likelihood (ML) estimator 
of its mean ($\hat{\mu}$) (e.g., the mean number of foci per cell) is equal to 
the arithmetic mean of counts in a data set.

The second cause of overdispersion is zero-inflation, an excessive number of 
zeros in a data set. We distinguish two causes for zero-inflation: either zeros 
occur naturally or false zeros are introduced by an unknown factor (e.g., foci 
not detected by the system). To describe zero-inflation we use the Zero-Inflated 
Poisson (ZIP) and the Zero-Inflated Negative Binomial (ZINB) distributions. The 
former is used to depict Poisson-distributed data, where overdispersion is 
caused by the excessive zeros and the latter for data where overdispersion 
arises from both increased variability of counts and zero-inflation. It is 
important to note, that in case of zero-inflated distributions, the mean number 
of counts $\lambda$ is not equal to the average number of foci per cell ($\mu$). 
To describe their relationship, we need to introduce another parameter, r, which 
is equal to the fraction of counts faulty turned to zeros. Using the introduced 
notation: $\lambda = \frac{\mu}{1 - r}$. Henceforth, if we do not correctly 
identify zero-inflation, we underestimate the real number of foci per cell.

Overdispersed distributions in most cases have variance larger than the 
Poisson-distributed counts with the same average number of foci per cell 
($\lambda$). In consequence, the confidence intervals are wider than in the case of 
the Poisson distribution. It directly affects the conclusion drawn from a data 
analysis, because bigger change of the mean number of foci is required, to 
support the significance of the impact of the treatment. 

Since overdispersion has serve impact on a data analysis, we created \emph{countfitteR} for 
determination of the count data distribution. Our software fits count data to 
four distributions, that describe counts: Poisson, NB, ZIP and ZINB. Although 
statistical tests designed for detecting overdispersion exist, they work 
properly only in a specific range of values. Furthermore, these tests only 
indicate that data is overdispersed, but do not point the suitable probability 
distribution. Therefore, \emph{countfitteR} selects the appropriate model using the Bayesian 
Information Criterion (BIC). The analysis is coupled with an estimation of 
parameters in the distribution of choice and their confidence intervals.  

The framework covers two most common situations. In the first approach, each 
count is separately fitted to all above mentioned distributions. This is 
preferable for situations, where counts come from various sources. The second 
approach relies on fitting globally all counts to a distribution. Such a model 
is appropriate among others for technical replicates.  

Our application is available as a web server that may be used in an 
analysis of $\gamma H2AX$ and 53BP1 count data. It is accompanied by 
an in-depth manual depicting the implemented framework and a rationale behind 
it. The guide covers both theoretical fundamentals and usage of \emph{countfitteR}, from a 
data import to a report generation. A publication is currently in preparation.

\emph{countfitteR} provides clinical scientists with a simple interface for the analysis of 
count data regardless of their biostatistical knowledge about the nature of the 
distribution. In the present study we used count data from an image based study 
of $\gamma H2AX$ foci. Analysis of such foci data is a common task both in life 
sciences and in diagnostics applications. Though \emph{countfitteR} was initially developed 
for modeling count data from the AKLIDES system, it may be used for foci 
data from other systems. Since our software is open source and accessible also 
from the command-line level, it is suitable for integration into other analysis 
pipelines dealing with count data. Therefore, we anticipate that our finding 
will have a broader use. The web server is accessible under: 
\url{update me}

\section{Functions from the command line}

\emph{countfitteR} has the following main functions that can
be used from the command line:

\begin{itemize}
    \item \textit{compare\_fit} to compare something,
    \item \textit{fit\_counts} to count something and
    \item \textit{plot\_fitcmp} to plot something.
\end{itemize}


\section{Data sets}

The data were prepared as described in \citep{rodiger_quantification_2018}.

\section{Another section}

This section may contain a figure such as Figure~\ref{figure:rlogo}.

\begin{figure}[htbp]
  \centering
  \includegraphics{Rlogo-5}
  \caption{The logo of R.}
  \label{figure:rlogo}
\end{figure}

\section{Another section}

There will likely be several sections, perhaps including code snippets, such as:

\begin{example}
  x <- 1:10
  result <- myFunction(x)
\end{example}

\section{Summary}

This file is only a basic article template. For full details of \emph{The R Journal} style and information on how to prepare your article for submission, see the \href{https://journal.r-project.org/share/author-guide.pdf}{Instructions for Authors}.

\bibliography{Chilmoniuk}

\address{Jaros\l{}aw Chilmoniuk\\
  Affiliation\\
  Address\\
  Country\\
  (ORCiD if desired)\\
  \email{author1@work}}

\address{Madeleine Ruhe\\
  Brandenburg University of Technology Cottbus - Senftenberg\\
  Universit\"atsplatz 1, Senftenberg\\
  Germany\\
  (ORCiD if desired)\\
  \email{Madeleine.Ruhe1@b-tu.de}}

\address{Stefan R\"{o}diger\\
  Brandenburg University of Technology Cottbus - Senftenberg\\
  Universit\"atsplatz 1, Senftenberg\\
  Germany\\
  (ORCiD: 0000-0002-1441-6512)\\
  \email{stefan.roediger@b-tu.de}}

\address{Micha\l{} Burdukiewicz\\
  Affiliation\\
  Address\\
  Country\\
  (ORCiD: 0000-0001-8926-582X)\\
  \email{michalburdukiewicz@gmail.com}}
